{% extends "base.html" %}
{% load static %}

{% block title %}국가별 추가 정보{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">국가별 추가 정보</h2>

  <div class="mb-3">
    <h5>현지 팁</h5>
    <ul class="list-group">
      <li class="list-group-item">Tip 1: <span id="tip1">로딩 중...</span></li>
      <li class="list-group-item">Tip 2: <span id="tip2">로딩 중...</span></li>
    </ul>
  </div>

  <div class="mb-3">
    <h5>환율 정보</h5>
    <p id="currency">로딩 중...</p>
  </div>

  <div class="mb-3">
    <h5>필수 백신</h5>
    <ul id="vaccine-list" class="list-group">
      <li class="list-group-item">로딩 중...</li>
    </ul>
  </div>

  <a href="/onboard/select-country/" class="btn btn-secondary mt-3">← 국가 다시 선택</a>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
  const urlParams = new URLSearchParams(window.location.search);
  const countryCode = urlParams.get('country_code');

  $(document).ready(function () {
    // 추가 팁 정보
    $.get(`/api/onboard/extra-info/?country_code=${countryCode}`, function (data) {
      $('#tip1').text(data.tip1 || '정보 없음');
      $('#tip2').text(data.tip2 || '정보 없음');
    });

    // 환율
    $.get(`/api/onboard/exchange-rate/?base=KRW&country_code=${countryCode}`, function (data) {
      if (data && data.rate) {
        $('#currency').text(`1 ${data.base} ≈ ${data.rate} ${data.target} (기준일: ${data.date})`);
      } else {
        $('#currency').text('환율 정보를 불러올 수 없습니다.');
      }
    });

    // 백신 정보
    $.get(`/api/onboard/required-vaccines/?country_code=${countryCode}`, function (data) {
      const list = $('#vaccine-list');
      list.empty();

      if (data.required_vaccines && data.required_vaccines.length > 0) {
        data.required_vaccines.forEach(v => {
          list.append(`<li class="list-group-item">${v}</li>`);
        });
      } else {
        list.append('<li class="list-group-item">요구되는 백신이 없습니다.</li>');
      }
    });
  });
</script>
{% endblock %}
